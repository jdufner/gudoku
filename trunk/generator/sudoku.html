<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
  <head>
    <title>Sudoku 2010-02</title>
    <meta name="author" content="Jürgen Dufner"/>
    <meta name="description" content="Sudoku"/>
    <meta name="keywords" content="Sudoku"/>
    <meta http-equiv="content-type" content="text/html; charset=ISO-8859-15"/>
    <style type="text/css">
<!--
* {
  font-family: Verdana, Arial, Helvetica, sans-serif;
}
table#board {
  margin: 10px;
}
table#board.solved {
  border: #00ff00 solid 2px;
}
td.fixed {
  font-size: 15px;
  font-weight: bold;
  text-align: center;
  vertical-align: middle;
  border: #999999 solid 1px;
  width: 40px;
  min-width: 40px;
  max-width: 40px;
  height: 40px;
  min-height: 40px;
  max-height: 40px;
  margin: 0px;
  padding: 0px;
  cursor: default;
}
td.candidate {
  font-size: 9px;
  font-weight: normal; 
  text-align: center;
  vertical-align: middle;
  width: 13px;
  min-width: 13px;
  max-width: 13px;
  height: 13px;
  min-height: 13px;
  max-height: 13px;
  cursor: default;
}
td.block1, td.block3, td.block5, td.block7, td.block9 {
  background-color: #FFFFFF;
}
td.block2, td.block4, td.block6, td.block8 {
  background-color: #CCCCCC;
}
td.original {
  color: #0000ff;
}
td.conflict {
  border: #ff0000 solid 1px;
}
/* Kandidaten per Knopf hervorheben */
td.highlight1 {
  background-color: #ffff99; /* gelb */
}
/* Kandidaten onmouseover / onmouseout */
td.highlight2 {
  background-color: #ff9999; /* rot */
}
/* Fixed / Zellen */
td.highlight3 {
  background-color: #99ff99; /* gruen */
}
td.hide {
  visibility: hidden;
}
div.candidateButtonOff {
  margin: 2px;
  padding: 2px;
  border: 2px #999999 outset;
  background-color: #ffff99;
  cursor: default;
}
div.candidateButtonOn {
  margin: 2px;
  padding: 2px;
  border: 2px #999999 inset;
  background-color: #cccc99;
  cursor: default;
}
-->
    </style>
  </head>
  <body>
    <h1>Sudoku 2010-02</h1>
    <div id="sudoku" style="float:left"></div>
    <div style="float:left; margin-left:10px;">
      <div>
        <fieldset>
          <legend>Statistik</legend>
          <p>Gesetzte Zellen: <input id="fixedCellNumber" style="float:right;" type="text" size="3" readonly="true" value=""/></p>
          <p>Verbleibende Kandidaten: <input id="candidateNumber" style="float:right;" type="text" size="3" readonly="true" value=""/></p>
        </fieldset>
      </div>
      <!-- float:left; margin-left:10px; -->
      <div style="">
        <fieldset>
          <legend>Lösung (<span id="solution" style="cursor:default;" onclick="switchVisibility('solution');">+</span>)</legend>
          <div id="solutionBlock" style="visibility:hidden; display:none;">
            <div id="steps" style="height:220px; min-height:220px; max-height:220px; width:600px; min-width:600px; max-width:600px; overflow:auto;"></div>
          </div>
        </fieldset>
      </div>
    </div>
    
    <div id="candidateButtons" style="float:left; margin-left:10px;"></div>
    <div id="buttons" style="clear:both; width:100%; margin-top:10px;">
      <select id="quests" name="quests" size="1"></select>
      <input type="button" value="Laden" onclick="copyAndLoadSudoku()"/><br/>
      <input id="sudokuAsString" type="text" value="" size="81"/>
      <input id="incloseCandidates" type="checkbox">inkl. Kandidaten</input><input type="button" value="Laden" onclick="loadSudoku()"/><input type="button" value="Speichern" onclick="saveSudoku()"/><br/>
      <input type="button" value="Kandidaten entfernen" onclick="removeAllCandidates()"/><input type="button" value="Reset" onclick="resetAllCandidates()"/><input type="button" value="Leeren" onclick="emptyCandidates()"/><input id="hideButton" type="button" value="Ausblenden" onclick="hideCandidates()"/><br/>
      <input type="button" value="Aus Cookie laden" onclick="loadSudokuFromCookie()"/><input type="button" value="In Cookie speichern" onclick="saveSudokuInCookie()"/><br/>
      <input id="undoButton" type="button" value="&lt;&lt; Zurück &lt;&lt;" onclick="undoCommand();"/><input id="doButton" type="button" value="&gt;&gt; Vor &gt;&gt;" onclick="doCommand();"/><br/>
      <fieldset style="width:45%;">
        <legend>Spielhilfe (<span id="configHelp" style="cursor:default;" onclick="switchVisibility('configHelp');">+</span>)</legend>
        <div id="configHelpBlock" style="visibility:hidden; display:none;">
          <input id="showConflicts" type="checkbox" checked="true" onclick="turnShowConflicts();saveConfig();">Fehler zeigen (funktioniert noch nicht)</input><br/>
          <input id="kandidatenEntfernen" type="radio" name="spielweise" value="kandidatenEntfernen" checked="true" onclick="saveConfig();">Kandidaten entfernen</input>
          <input id="kandidatenSetzen" type="radio" name="spielweise" value="kandidatenSetzen" onclick="saveConfig();">Kandidaten setzen</input>
        </div>
      </fieldset>
      <fieldset style="float:left; width:45%;">
        <legend>Zellen (<span id="configCellHighlight" style="cursor:default;" onclick="switchVisibility('configCellHighlight');">+</span>)</legend>
        <div id="configCellHighlightBlock" style="visibility:hidden; display:none;">
          <input id="highlightFixed" type="checkbox" checked="true">Zellen hervorheben</input><br/>
          <input id="highlightAllFixed" type="checkbox">Auch andere Zellen hervorheben</input><br/>
          <input id="highlightAllFixedAndCandidates" type="checkbox">Auch andere Kandidaten hervorheben</input><br/>
        </div>
      </fieldset>
      <fieldset style="float:left; width:45%;">
        <legend>Kandidaten (<span id="configCandidateHighlight" style="cursor:default;" onclick="switchVisibility('configCandidateHighlight');">+</span>)</legend>
        <div id="configCandidateHighlightBlock" style="visibility:hidden; display:none;">
          <input id="highlightCandidates" type="checkbox" checked="true">Kandidaten hervorheben</input><br/>
          <input id="highlightAllCandidates" type="checkbox">Auch andere Kandidaten hervorheben</input><br/>
          <input id="highlightAllCandidatesAndFixed" type="checkbox">Auch andere Zellen hervorheben</input><br/>
        </div>
      </fieldset>
      <div style="clear:both"></div>
    </div>
  </body>
  <script language="javascript">
<!--
var size = 9;
var subSize = 3;
var original;
var doCmd = new Array();
var undoCmd = new Array();
var updateStatisticsId;
var sudoku = null;
var sudokus = [
new solution(53967, "....4...6.........6....534.59...8.6.....3.7..4.1..7.....5.8.4..72........6..2.83.", "153842976849673152672195348597418263286539714431267589315986427728354691964721835", "sehr leicht", true, [
new step("SIMPLE", "....4...6.........6....534.59...8.6.....3.7..4.1..7.....5.8.4..72........6..2.83.", 24, 513, ["1RM4567","2RM2469","3RM1456","4RM456","6RM45678","7RM34678","8RM346","10RM4567","11RM269","12RM156","13RM45","14RM23458","15RM4578","16RM34678","18RM346","17RM346","20RM234569","22RM3456","21RM13456","23RM234568","27RM3456","30RM145689","32RM23456789","31RM356789","36RM56789","34RM3456789","39RM134579","40RM378","37RM1345679","38RM12345679","44RM3467","42RM3578","47RM1245679","45RM367","52RM134678","50RM123478","49RM13478","56RM2456789","55RM245678","54RM1467","53RM13467","60RM24578","58RM2458","63RM34568","62RM34568","69RM2578","70RM23478","71RM234678","72RM234678","66RM12567","67RM278","68RM23478","78RM235678","73RM2345678","75RM1235678","76RM2368","81RM23468"])
,new step("SIMPLE", "1-2-3-8-9,1-3-5-7-8,2-3-7-8-9,1-2-3-7-8-9,4,1-2-3-9,1-2-5-9,1-2-5-7-8-9,6,1-2-3-8-9,1-3-4-5-7-8,2-3-4-7-8-9,1-2-3-6-7-8-9,1-6-7-9,1-2-3-6-9,1-2-5-9,1-2-5-7-8-9,1-2-5-7-8-9,6,1-7-8,2-7-8-9,1-2-7-8-9,1-7-9,5,3,4,1-2-7-8-9,5,9,2-3-7,1-2-4,1,8,1-2,6,1-2-3-4,2-8,8,2-6-8,1-2-4-5-6-9,3,1-2-4-6-9,7,1-2-5-8-9,1-2-4-5-8-9,4,3-8,1,2-5-6-9,5-6-9,7,2-5-9,2-5-8-9,2-3-5-8-9,1-3-9,1-3,5,1-3-6-7-9,8,1-3-6-9,4,1-2-7-9,1-2-7-9,7,2,3-4-8-9,1-3-4-5-6-9,1-5-6-9,1-3-4-6-9,1-5-6-9,1-5-9,1-5-9,1-9,6,4-9,1-4-5-7-9,2,1-4-9,8,3,1-5-7-9", 26, 231, ["2RM2689","36RM15689","34RM15689","39RM1345789","40RM1378","37RM1345789","68RM12348","44RM378","11RM2689","42RM1378","47RM1245689","14RM12348","45RM378","20RM2689","23RM12348","31RM1356789"])
,new step("SIMPLE", "1-2-3-8-9,1-3-5-7,2-3-7-8-9,1-2-3-7-8-9,4,1-2-3-9,1-2-5-9,1-2-5-7-8-9,6,1-2-3-8-9,1-3-4-5-7,2-3-4-7-8-9,1-2-3-6-7-8-9,6-7-9,1-2-3-6-9,1-2-5-9,1-2-5-7-8-9,1-2-5-7-8-9,6,1-7,2-7-8-9,1-2-7-8-9,7-9,5,3,4,1-2-7-8-9,5,9,2-3-7,2-4,1,8,2,6,2-3-4,2,8,2-6,2-4-5-6-9,3,2-4-6-9,7,1-2-5-9,1-2-4-5-9,4,3,1,2-5-6-9,5-6-9,7,2-5-9,2-5-8-9,2-3-5-8-9,1-3-9,1-3,5,1-3-6-7-9,8,1-3-6-9,4,1-2-7-9,1-2-7-9,7,2,3-4-8-9,1-3-4-5-6-9,5-6-9,1-3-4-6-9,1-5-6-9,1-5-9,1-5-9,1-9,6,4-9,1-4-5-7-9,2,1-4-9,8,3,1-5-7-9", 29, 212, ["1RM24567","2RM23689","36RM1256789","39RM12345789","40RM2378","7RM23478","44RM23678","10RM24567","11RM23689","42RM2378","45RM23678","16RM23478","52RM234678","56RM23689","54RM123467","53RM267","30RM12345689","31RM125689"])
,new step("SIMPLE", "1-3-8-9,1-5-7,2-3-7-8-9,1-2-3-7-8-9,4,1-2-3-9,1-5-9,1-2-5-7-8-9,6,1-3-8-9,1-4-5-7,2-3-4-7-8-9,1-2-3-6-7-8-9,6-7-9,1-2-3-6-9,1-5-9,1-2-5-7-8-9,1-2-5-7-8-9,6,1-7,2-7-8-9,1-2-7-8-9,7-9,5,3,4,1-2-7-8-9,5,9,7,4,1,8,2,6,3-4,2,8,6,4-5-6-9,3,4-6-9,7,1-5-9,1-4-5-9,4,3,1,2-5-6-9,5-6-9,7,5-9,5-8-9,5-8-9,1-3-9,1,5,1-3-6-7-9,8,1-3-6-9,4,1-2-7-9,1-2-7-9,7,2,3-4-8-9,1-3-4-5-6-9,5-6-9,1-3-4-6-9,1-5-6-9,1-5-9,1-5-9,1-9,6,4-9,1-4-5-7-9,2,1-4-9,8,3,1-5-7-9", 33, 188, ["2RM123689","36RM12456789","3RM1567","40RM1234678","67RM4","11RM123689","42RM1234678","12RM1567","73RM12567","76RM4","20RM123689","55RM1245678","21RM1567","60RM1458","58RM1458","63RM1458","62RM1458"])
,new step("SIMPLE", "1-3-8-9,5-7,2-3-8-9,1-2-3-7-8-9,4,1-2-3-9,1-5-9,1-2-5-7-8-9,6,1-3-8-9,4-5-7,2-3-4-8-9,1-2-3-6-7-8-9,6-7-9,1-2-3-6-9,1-5-9,1-2-5-7-8-9,1-2-5-7-8-9,6,7,2-8-9,1-2-7-8-9,7-9,5,3,4,1-2-7-8-9,5,9,7,4,1,8,2,6,3,2,8,6,5-9,3,9,7,1-5-9,1-4-5-9,4,3,1,2-5-6-9,5-6-9,7,5-9,5-8-9,5-8-9,3-9,1,5,3-6-7-9,8,3-6-9,4,2-7-9,2-7-9,7,2,3-4-8-9,1-3-5-6-9,5-6-9,1-3-4-6-9,1-5-6-9,1-5-9,1-5-9,9,6,4-9,1-5-7-9,2,1-4-9,8,3,1-5-7-9", 37, 165, ["69RM5789","1RM245679","2RM1236789","66RM125679","6RM5789","40RM12346789","78RM2356789","44RM236789","10RM245679","11RM1236789","15RM5789","45RM236789","75RM12356789","76RM23689","50RM134789","49RM134789","22RM34567","81RM23689","55RM1245679","23RM34567","60RM5789","27RM34567"])
,new step("SIMPLE", "1-3-8,5,2-3-8-9,1-2-3-7-8-9,4,1-2-3,1-5-9,1-2-5-7-8-9,6,1-3-8,4-5,2-3-4-8-9,1-2-3-6-7-8-9,6-7-9,1-2-3-6,1-5-9,1-2-5-7-8-9,1-2-5-7-8-9,6,7,2-8-9,1-2-8-9,9,5,3,4,1-2-8-9,5,9,7,4,1,8,2,6,3,2,8,6,5,3,9,7,1-5,1-4-5,4,3,1,2-5-6,5-6,7,5-9,5-8-9,5-8-9,3,1,5,3-6-7-9,8,3-6,4,2-7-9,2-7-9,7,2,3-4-8,1-3-5-6-9,5-6-9,1-3-4-6,1-5-6-9,1-5-9,1-5-9,9,6,4,1-5-7,2,1-4,8,3,1-5-7", 42, 138, ["1RM2345679","4RM459","66RM12345679","67RM45","7RM456","68RM123489","8RM456","78RM234689","44RM2356789","10RM2345679","11RM12356789","12RM14567","13RM459","14RM1234589","45RM2356789","76RM45","50RM1345789","49RM1345789","22RM345679","21RM345679","60RM13458","58RM13458","27RM345679"])
,new step("SIMPLE", "1-8,5,2-3-8-9,1-2-3-7-8,4,1-2-3,1-9,1-2-7-8-9,6,1-8,4,2-3-8-9,1-2-3-6-7-8,6-7,1-2-3-6,1-5-9,1-2-5-7-8-9,1-2-5-7-8-9,6,7,2-8,1-2-8,9,5,3,4,1-2-8,5,9,7,4,1,8,2,6,3,2,8,6,5,3,9,7,1,1-4,4,3,1,2-6,6,7,5-9,5-8-9,5-8-9,3,1,5,6-7-9,8,6,4,2-7-9,2-7-9,7,2,8,1-3-6-9,5-6,1-3-4-6,1-5-6-9,1-5-9,1-5-9,9,6,4,1-7,2,1,8,3,1-5-7", 48, 108, ["69RM1256789","3RM145678","71RM1346","6RM156789","67RM1268","68RM1234689","8RM1346","12RM145678","14RM1234689","15RM156789","45RM12356789","76RM1234689","17RM1346","49RM13456789","81RM1234689","21RM145678","58RM1234568"])
,new step("SIMPLE", "1-8,5,2-3-9,1-2-3-7-8,4,2-3,1-9,2-7-8-9,6,1-8,4,2-3-9,1-2-3-6-7-8,7,2-3,1-5-9,2-5-7-8-9,1-2-5-7-8-9,6,7,2,1-2-8,9,5,3,4,1-2-8,5,9,7,4,1,8,2,6,3,2,8,6,5,3,9,7,1,4,4,3,1,2,6,7,5-9,5-8-9,5-8-9,3,1,5,7-9,8,6,4,2-7-9,2-7-9,7,2,8,3-9,5,3-4,1-5-6-9,5-9,1-5-9,9,6,4,7,2,1,8,3,5-7", 54, 82, ["70RM2578","71RM2578","3RM1245678","4RM24579","72RM2578","12RM1245678","13RM24579","18RM47","17RM47","22RM2345679","81RM12346789","58RM1245678","27RM2345679"])
,new step("SIMPLE", "1-8,5,3-9,1-3-8,4,2-3,1-9,2-7-8-9,6,1-8,4,3-9,1-3-6-8,7,2-3,1-5-9,2-5-8-9,1-2-5-8-9,6,7,2,1-8,9,5,3,4,1-8,5,9,7,4,1,8,2,6,3,2,8,6,5,3,9,7,1,4,4,3,1,2,6,7,5-9,5-8-9,5-8-9,3,1,5,9,8,6,4,2-7-9,2-7-9,7,2,8,3-9,5,3-4,1-6-9,9,1-9,9,6,4,7,2,1,8,3,5", 57, 64, ["18RM3456","17RM13469","70RM2345789","72RM2345789","54RM3456","67RM12456789","8RM13469","53RM13469","63RM1345689","62RM1345689"])
,new step("SIMPLE", "1-8,5,3-9,1-3-8,4,2-3,1-9,2-7-8,6,1-8,4,3-9,1-3-6-8,7,2-3,1-5-9,2-5-8,1-2-8-9,6,7,2,1-8,9,5,3,4,1-8,5,9,7,4,1,8,2,6,3,2,8,6,5,3,9,7,1,4,4,3,1,2,6,7,5-9,5-8,8-9,3,1,5,9,8,6,4,2-7,2-7,7,2,8,3,5,3-4,1-6,9,1,9,6,4,7,2,1,8,3,5", 59, 52, ["18RM13456","69RM12356789","70RM12345789","4RM234579","27RM13456","13RM234579"])
,new step("SIMPLE", "1-8,5,3-9,1-8,4,2-3,1-9,2-7-8,6,1-8,4,3-9,1-6-8,7,2-3,1-5-9,2-5-8,2-8-9,6,7,2,1-8,9,5,3,4,8,5,9,7,4,1,8,2,6,3,2,8,6,5,3,9,7,1,4,4,3,1,2,6,7,5-9,5-8,8-9,3,1,5,9,8,6,4,2-7,2-7,7,2,8,3,5,4,6,9,1,9,6,4,7,2,1,8,3,5", 62, 43, ["18RM134568","17RM3468","22RM23456789","54RM134568","8RM3468"])
,new step("SIMPLE", "1-8,5,3-9,1-8,4,2-3,1-9,2-7,6,1-8,4,3-9,1-6-8,7,2-3,1-5-9,2-5,2-9,6,7,2,1,9,5,3,4,8,5,9,7,4,1,8,2,6,3,2,8,6,5,3,9,7,1,4,4,3,1,2,6,7,5-9,5-8,9,3,1,5,9,8,6,4,2-7,2-7,7,2,8,3,5,4,6,9,1,9,6,4,7,2,1,8,3,5", 64, 36, ["52RM1234679","18RM1345689","4RM1234579","13RM1234579"])
,new step("SIMPLE", "1-8,5,3-9,8,4,2-3,1-9,2-7,6,1-8,4,3-9,6-8,7,2-3,1-5-9,2-5,2,6,7,2,1,9,5,3,4,8,5,9,7,4,1,8,2,6,3,2,8,6,5,3,9,7,1,4,4,3,1,2,6,7,5,5-8,9,3,1,5,9,8,6,4,2-7,2-7,7,2,8,3,5,4,6,9,1,9,6,4,7,2,1,8,3,5", 67, 29, ["1RM4568","17RM234678","8RM23468","53RM12345679","13RM12345789","63RM12345689","15RM247","16RM2345678"])
,new step("SIMPLE", "1,5,3-9,8,4,2-3,1-9,7,6,1-8,4,3-9,6,7,3,1-9,5,2,6,7,2,1,9,5,3,4,8,5,9,7,4,1,8,2,6,3,2,8,6,5,3,9,7,1,4,4,3,1,2,6,7,5,8,9,3,1,5,9,8,6,4,2-7,7,7,2,8,3,5,4,6,9,1,9,6,4,7,2,1,8,3,5", 74, 14, ["6RM13456789","7RM145678","10RM12345679","12RM234567","62RM13456789"])
,new step("SIMPLE", "1,5,3-9,8,4,2,9,7,6,8,4,9,6,7,3,1-9,5,2,6,7,2,1,9,5,3,4,8,5,9,7,4,1,8,2,6,3,2,8,6,5,3,9,7,1,4,4,3,1,2,6,7,5,8,9,3,1,5,9,8,6,4,2,7,7,2,8,3,5,4,6,9,1,9,6,4,7,2,1,8,3,5", 79, 4, ["3RM12456789","16RM23456789"])
])
,new solution(54317, "....4.7.6......3.2..96...4.49...7....183...6.....6...887....5.....1...8.....23...", "321548796684719352759632841496287135218354967537961428872496513963175284145823679", "sehr leicht", true, [
new step("SIMPLE", "....4.7.6......3.2..96...4.49...7....183...6.....6...887....5.....1...8.....23...", 24, 513, ["1RM46789","2RM14679","3RM46789","4RM13467","6RM3467","8RM234678","10RM23489","11RM12379","12RM2389","13RM12346","14RM2346","15RM23467","17RM234678","20RM14679","19RM4689","24RM34679","23RM2469","25RM2345679","27RM2346789","30RM14789","32RM234679","31RM134679","35RM46789","36RM246789","34RM3456789","37RM134689","43RM135678","41RM1234678","42RM13678","47RM146789","48RM14689","45RM12368","46RM14689","52RM35678","51RM3678","49RM13678","53RM468","60RM123578","59RM12345678","58RM1235678","57RM5789","64RM1478","63RM25678","62RM45678","69RM12378","70RM13578","72RM12568","65RM1789","66RM1789","68RM123468","79RM23578","80RM234568","73RM23478","74RM123789","75RM23789","76RM1236","81RM23568"])
,new step("SIMPLE", "1-2-3-5,2-3-5-8,1-2-3-5,2-5-8-9,4,1-2-5-8-9,7,1-5-9,6,1-5-6-7,4-5-6-8,1-4-5-6-7,5-7-8-9,1-5-7-8-9,1-5-8-9,3,1-5-9,2,1-2-3-5-7,2-3-5-8,9,6,1-3-5-7-8,1-2-5-8,1-8,4,1-5,4,9,2-3-5-6,2-5-8,1-5-8,7,1-2,1-2-3-5,1-3-5,2-5-7,1,8,3,5-9,2-4-5-9,2-4-9,6,4-5-7-9,2-3-5-7,2-3-5,2-3-5-7,2-4-5-9,6,1-2-4-5-9,1-2-4-9,1-2-3-5-7-9,8,8,7,1-2-3-4-6,4-9,9,4-6-9,5,1-2-3-9,1-3-4-9,2-3-5-6-9,2-3-4-5-6,2-3-4-5-6,1,5-7-9,4-5-6-9,2-4-6-9,8,3-4-7-9,1-5-6-9,4-5-6,1-4-5-6,4-5-7-8-9,2,3,1-4-6-9,1-7-9,1-4-7-9", 25, 215, ["69RM1239","68RM123469","60RM1235789","41RM2469","58RM1235789","14RM2469","63RM5789","62RM5789","76RM1239"])
,new step("SIMPLE", "1-2-3-5,2-3-5-8,1-2-3-5,2-5-8-9,4,1-2-5-8-9,7,1-5-9,6,1-5-6-7,4-5-6-8,1-4-5-6-7,5-7-8-9,1-5-7-8,1-5-8-9,3,1-5-9,2,1-2-3-5-7,2-3-5-8,9,6,1-3-5-7-8,1-2-5-8,1-8,4,1-5,4,9,2-3-5-6,2-5-8,1-5-8,7,1-2,1-2-3-5,1-3-5,2-5-7,1,8,3,5,2-4-5-9,2-4-9,6,4-5-7-9,2-3-5-7,2-3-5,2-3-5-7,2-4-5-9,6,1-2-4-5-9,1-2-4-9,1-2-3-5-7-9,8,8,7,1-2-3-4-6,4,9,4-6,5,1-2-3,1-3-4,2-3-5-6-9,2-3-4-5-6,2-3-4-5-6,1,5-7,4-5-6,2-4-6-9,8,3-4-7-9,1-5-6-9,4-5-6,1-4-5-6,4-5-7-8,2,3,1-4-6-9,1-7-9,1-4-7-9", 27, 204, ["69RM12349","37RM13568","68RM24569","42RM135678","14RM24569","45RM13568","76RM123469","51RM3567","49RM134567","23RM24569","60RM12345789","57RM45789","63RM45789","32RM2345679","31RM3567"])
,new step("SIMPLE", "1-2-3-5,2-3-5-8,1-2-3-5,2-5-8-9,4,1-2-5-8-9,7,1-5-9,6,1-5-6-7,4-5-6-8,1-4-5-6-7,5-7-8-9,1-7-8,1-5-8-9,3,1-5-9,2,1-2-3-5-7,2-3-5-8,9,6,1-3-7-8,1-2-5-8,1-8,4,1-5,4,9,2-3-5-6,2-8,1-8,7,1-2,1-2-3-5,1-3-5,2-7,1,8,3,5,2-4-9,2-4-9,6,4-7-9,2-3-5-7,2-3-5,2-3-5-7,2-9,6,1-2-4-9,1-2-4-9,1-2-3-5-7-9,8,8,7,1-2-3-6,4,9,6,5,1-2-3,1-3,2-3-5-6-9,2-3-4-5-6,2-3-4-5-6,1,7,5-6,2-4-6-9,8,3-4-7-9,1-5-6-9,4-5-6,1-4-5-6,5-7-8,2,3,1-4-6-9,1-7-9,1-4-7-9", 29, 186, ["69RM1234679","72RM178","23RM245679","57RM456789","14RM245679","76RM1234679"])
,new step("SIMPLE", "1-2-3-5,2-3-5-8,1-2-3-5,2-5-8-9,4,1-2-5-8-9,7,1-5-9,6,1-5-6-7,4-5-6-8,1-4-5-6-7,5-7-8-9,1-8,1-5-8-9,3,1-5-9,2,1-2-3-5-7,2-3-5-8,9,6,1-3-8,1-2-5-8,1-8,4,1-5,4,9,2-3-5-6,2-8,1-8,7,1-2,1-2-3-5,1-3-5,2-7,1,8,3,5,2-4-9,2-4-9,6,4-7-9,2-3-5-7,2-3-5,2-3-5-7,2-9,6,1-2-4-9,1-2-4-9,1-2-3-5-7-9,8,8,7,1-2-3,4,9,6,5,1-2-3,1-3,2-3-5-6-9,2-3-4-5-6,2-3-4-5-6,1,7,5,2-4-6-9,8,3-4-9,1-5-6-9,4-5-6,1-4-5-6,5-8,2,3,1-4-6-9,1-7-9,1-4-7-9", 30, 179, ["65RM1578","66RM1578","6RM3567","24RM3567","64RM1578","15RM3567","76RM12345679"])
,new step("SIMPLE", "1-2-3-5,2-3-5-8,1-2-3-5,2-5-8-9,4,1-2-8-9,7,1-5-9,6,1-5-6-7,4-5-6-8,1-4-5-6-7,5-7-8-9,1-8,1-8-9,3,1-5-9,2,1-2-3-5-7,2-3-5-8,9,6,1-3-8,1-2-8,1-8,4,1-5,4,9,2-3-5-6,2-8,1-8,7,1-2,1-2-3-5,1-3-5,2-7,1,8,3,5,2-4-9,2-4-9,6,4-7-9,2-3-5-7,2-3-5,2-3-5-7,2-9,6,1-2-4-9,1-2-4-9,1-2-3-5-7-9,8,8,7,1-2-3,4,9,6,5,1-2-3,1-3,2-3-6-9,2-3-4-6,2-3-4-6,1,7,5,2-4-6-9,8,3-4-9,1-5-6-9,4-5-6,1-4-5-6,8,2,3,1-4-6-9,1-7-9,1-4-7-9", 31, 171, ["4RM13468","13RM13468","31RM13468"])
,new step("SIMPLE", "1-2-3-5,2-3-5-8,1-2-3-5,2-5-9,4,1-2-8-9,7,1-5-9,6,1-5-6-7,4-5-6-8,1-4-5-6-7,5-7-9,1-8,1-8-9,3,1-5-9,2,1-2-3-5-7,2-3-5-8,9,6,1-3-8,1-2-8,1-8,4,1-5,4,9,2-3-5-6,2,1-8,7,1-2,1-2-3-5,1-3-5,2-7,1,8,3,5,2-4-9,2-4-9,6,4-7-9,2-3-5-7,2-3-5,2-3-5-7,2-9,6,1-2-4-9,1-2-4-9,1-2-3-5-7-9,8,8,7,1-2-3,4,9,6,5,1-2-3,1-3,2-3-6-9,2-3-4-6,2-3-4-6,1,7,5,2-4-6-9,8,3-4-9,1-5-6-9,4-5-6,1-4-5-6,8,2,3,1-4-6-9,1-7-9,1-4-7-9", 32, 167, ["35RM2479","51RM23567","4RM123468","34RM2479","49RM12345678","42RM23567","30RM2479"])
,new step("SIMPLE", "1-2-3-5,2-3-5-8,1-2-3-5,5-9,4,1-2-8-9,7,1-5-9,6,1-5-6-7,4-5-6-8,1-4-5-6-7,5-7-9,1-8,1-8-9,3,1-5-9,2,1-2-3-5-7,2-3-5-8,9,6,1-3-8,1-2-8,1-8,4,1-5,4,9,3-5-6,2,1-8,7,1,1-3-5,1-3-5,2-7,1,8,3,5,4-9,2-4-9,6,4-7-9,2-3-5-7,2-3-5,2-3-5-7,9,6,1-4-9,1-2-4-9,1-2-3-5-7-9,8,8,7,1-2-3,4,9,6,5,1-2-3,1-3,2-3-6-9,2-3-4-6,2-3-4-6,1,7,5,2-4-6-9,8,3-4-9,1-5-6-9,4-5-6,1-4-5-6,8,2,3,1-4-6-9,1-7-9,1-4-7-9", 34, 158, ["52RM1356789","35RM1246789","51RM2356789","36RM1246789","4RM1234689","53RM1689","25RM1357","79RM1357","42RM235679","13RM1234689","32RM12479"])
,new step("SIMPLE", "1-2-3-5,2-3-5-8,1-2-3-5,5,4,1-2-8-9,7,1-5-9,6,1-5-6-7,4-5-6-8,1-4-5-6-7,5-7,1-8,1-8-9,3,1-5-9,2,1-2-3-5-7,2-3-5-8,9,6,1-3-8,1-2-8,8,4,1-5,4,9,3-5-6,2,8,7,1,3-5,3-5,2-7,1,8,3,5,4,2-4-9,6,4-7-9,2-3-5-7,2-3-5,2-3-5-7,9,6,1-4,2-4,2-3-5-7,8,8,7,1-2-3,4,9,6,5,1-2-3,1-3,2-3-6-9,2-3-4-6,2-3-4-6,1,7,5,2-4-6-9,8,3-4-9,1-5-6-9,4-5-6,1-4-5-6,8,2,3,4-6-9,1-7-9,1-4-7-9", 38, 141, ["1RM4567","51RM23456789","2RM4567","3RM4567","20RM4689","24RM4689","23RM2456789","8RM4567","43RM134568","13RM12345689","14RM2456789","45RM134568"])
,new step("SIMPLE", "1-2-3,2-3-8,1-2-3,5,4,1-2-8-9,7,1-9,6,1-5-6-7,4-5-6-8,1-4-5-6-7,7,1,1-8-9,3,1-5-9,2,1-2-3-5-7,2-3-5,9,6,1-3,1-2,8,4,1-5,4,9,3-5-6,2,8,7,1,3-5,3-5,2-7,1,8,3,5,4,2-9,6,7-9,2-3-5-7,2-3-5,2-3-5-7,9,6,1,2-4,2-3-5-7,8,8,7,1-2-3,4,9,6,5,1-2-3,1-3,2-3-6-9,2-3-4-6,2-3-4-6,1,7,5,2-4-6-9,8,3-4-9,1-5-6-9,4-5-6,1-4-5-6,8,2,3,4-6-9,1-7-9,1-4-7-9", 41, 126, ["17RM1237","6RM134567","24RM134567","23RM12456789","10RM1237","12RM1237","15RM1234567"])
,new step("SIMPLE", "1-2-3,2-3-8,1-2-3,5,4,2-8-9,7,1-9,6,5-6,4-5-6-8,4-5-6,7,1,8-9,3,5-9,2,1-2-3-5-7,2-3-5,9,6,3,2,8,4,1-5,4,9,3-5-6,2,8,7,1,3-5,3-5,2-7,1,8,3,5,4,2-9,6,7-9,2-3-5-7,2-3-5,2-3-5-7,9,6,1,2-4,2-3-5-7,8,8,7,1-2-3,4,9,6,5,1-2-3,1-3,2-3-6-9,2-3-4-6,2-3-4-6,1,7,5,2-4-6-9,8,3-4-9,1-5-6-9,4-5-6,1-4-5-6,8,2,3,4-6-9,1-7-9,1-4-7-9", 43, 115, ["20RM234689","19RM234689","6RM1234567"])
,new step("SIMPLE", "1-2-3,2-3-8,1-2-3,5,4,8-9,7,1-9,6,5-6,4-5-6-8,4-5-6,7,1,8-9,3,5-9,2,1-5-7,5,9,6,3,2,8,4,1-5,4,9,3-5-6,2,8,7,1,3-5,3-5,2-7,1,8,3,5,4,2-9,6,7-9,2-3-5-7,2-3-5,2-3-5-7,9,6,1,2-4,2-3-5-7,8,8,7,1-2-3,4,9,6,5,1-2-3,1-3,2-3-6-9,2-3-4-6,2-3-4-6,1,7,5,2-4-6-9,8,3-4-9,1-5-6-9,4-5-6,1-4-5-6,8,2,3,4-6-9,1-7-9,1-4-7-9", 44, 109, ["19RM2345689","10RM59","11RM1579","12RM59","27RM2345689","47RM1579","74RM1579"])
,new step("SIMPLE", "1-2-3,2-3-8,1-2-3,5,4,8-9,7,1-9,6,6,4-6-8,4-6,7,1,8-9,3,5-9,2,1-7,5,9,6,3,2,8,4,1,4,9,3-5-6,2,8,7,1,3-5,3-5,2-7,1,8,3,5,4,2-9,6,7-9,2-3-5-7,2-3,2-3-5-7,9,6,1,2-4,2-3-5-7,8,8,7,1-2-3,4,9,6,5,1-2-3,1-3,2-3-6-9,2-3-4-6,2-3-4-6,1,7,5,2-4-6-9,8,3-4-9,1-5-6-9,4-6,1-4-5-6,8,2,3,4-6-9,1-7-9,1-4-7-9", 46, 100, ["19RM12345689","81RM1268","8RM1234678","11RM1235679","12RM1235679","73RM468","64RM468","63RM1268"])
,new step("SIMPLE", "1-2-3,2-3-8,1-2-3,5,4,8-9,7,9,6,6,4-8,4,7,1,8-9,3,5-9,2,7,5,9,6,3,2,8,4,1,4,9,3-5-6,2,8,7,1,3-5,3-5,2-7,1,8,3,5,4,2-9,6,7-9,2-3-5-7,2-3,2-3-5-7,9,6,1,2-4,2-3-5-7,8,8,7,1-2-3,4,9,6,5,1-2-3,3,2-3-9,2-3-4-6,2-3-4-6,1,7,5,2-4-6-9,8,3-4-9,1-5-9,4-6,1-4-5-6,8,2,3,4-6-9,1-7-9,4-7-9", 50, 88, ["36RM12368","17RM12346789","72RM123568","66RM489","6RM45679","37RM4678","11RM12345679","80RM4689","57RM3456789","75RM489","62RM3456789","46RM4678"])
,new step("SIMPLE", "1-2-3,2-3-8,1-2-3,5,4,8,7,9,6,6,8,4,7,1,8-9,3,5,2,7,5,9,6,3,2,8,4,1,4,9,3-5-6,2,8,7,1,3-5,5,2,1,8,3,5,4,2-9,6,7-9,2-3-5,2-3,2-3-5-7,9,6,1,2-4,2-3-5-7,8,8,7,1-2,4,9,6,5,1-2,3,2-3-9,2-3-4-6,2-3-6,1,7,5,2-4-6-9,8,4-9,1-5-9,4-6,1-5-6,8,2,3,4-6-9,1-7,4-7-9", 55, 71, ["1RM24678","35RM12456789","2RM1456789","53RM145689","43RM1234568","47RM12489","30RM1245789","64RM24678","48RM12489","15RM12345678","46RM1246789"])
,new step("SIMPLE", "1-3,2-3,1-2-3,5,4,8,7,9,6,6,8,4,7,1,9,3,5,2,7,5,9,6,3,2,8,4,1,4,9,3-6,2,8,7,1,3,5,2,1,8,3,5,4,9,6,7-9,3-5,3,3-5-7,9,6,1,2-4,2-3-7,8,8,7,1-2,4,9,6,5,1-2,3,3-9,2-3-4-6,2-3-6,1,7,5,2-4-6-9,8,4-9,1-5-9,4-6,1-5-6,8,2,3,4-6-9,1-7,4-7-9", 59, 56, ["2RM135789","70RM135789","65RM135789","53RM1345689","79RM135789","30RM12345789","48RM1234689","45RM12345689","46RM1234689"])
,new step("SIMPLE", "1-3,2,1-2-3,5,4,8,7,9,6,6,8,4,7,1,9,3,5,2,7,5,9,6,3,2,8,4,1,4,9,6,2,8,7,1,3,5,2,1,8,3,5,4,9,6,7,5,3,5-7,9,6,1,2-4,2-7,8,8,7,1-2,4,9,6,5,1-2,3,3-9,2-4-6,2-3-6,1,7,5,2-4-6,8,4-9,1-5-9,4-6,1-5-6,8,2,3,4-6,1-7,4-7-9", 63, 43, ["3RM2456789","65RM1235789","66RM4689","81RM1235678","53RM1356789","73RM245678","48RM12345689","75RM4689"])
,new step("SIMPLE", "1-3,2,1-3,5,4,8,7,9,6,6,8,4,7,1,9,3,5,2,7,5,9,6,3,2,8,4,1,4,9,6,2,8,7,1,3,5,2,1,8,3,5,4,9,6,7,5,3,7,9,6,1,2-4,2,8,8,7,1-2,4,9,6,5,1-2,3,3-9,4-6,2-3,1,7,5,2-4-6,8,4-9,1-9,4-6,1-5,8,2,3,4-6,1-7,4-9", 65, 33, ["52RM12356789","62RM2345689"])
,new step("SIMPLE", "1-3,2,1-3,5,4,8,7,9,6,6,8,4,7,1,9,3,5,2,7,5,9,6,3,2,8,4,1,4,9,6,2,8,7,1,3,5,2,1,8,3,5,4,9,6,7,5,3,7,9,6,1,4,2,8,8,7,1-2,4,9,6,5,1,3,3-9,4-6,2-3,1,7,5,2-4-6,8,4-9,1-9,4-6,1-5,8,2,3,4-6,1-7,4-9", 67, 29, ["70RM1345789","79RM1345789","57RM13456789","80RM12345689"])
,new step("SIMPLE", "1-3,2,1-3,5,4,8,7,9,6,6,8,4,7,1,9,3,5,2,7,5,9,6,3,2,8,4,1,4,9,6,2,8,7,1,3,5,2,1,8,3,5,4,9,6,7,5,3,7,9,6,1,4,2,8,8,7,2,4,9,6,5,1,3,3-9,4-6,2-3,1,7,5,2-6,8,4-9,1-9,4-6,1-5,8,2,3,6,7,4-9", 70, 22, ["70RM13456789","66RM246789","74RM23678"])
,new step("SIMPLE", "1-3,2,1-3,5,4,8,7,9,6,6,8,4,7,1,9,3,5,2,7,5,9,6,3,2,8,4,1,4,9,6,2,8,7,1,3,5,2,1,8,3,5,4,9,6,7,5,3,7,9,6,1,4,2,8,8,7,2,4,9,6,5,1,3,3-9,4-6,3,1,7,5,2,8,4-9,1-9,4,1-5,8,2,3,6,7,4-9", 73, 16, ["3RM2346789","65RM12345789","81RM234678","64RM1234578"])
,new step("SIMPLE", "1-3,2,1,5,4,8,7,9,6,6,8,4,7,1,9,3,5,2,7,5,9,6,3,2,8,4,1,4,9,6,2,8,7,1,3,5,2,1,8,3,5,4,9,6,7,5,3,7,9,6,1,4,2,8,8,7,2,4,9,6,5,1,3,9,6,3,1,7,5,2,8,4-9,1-9,4,1-5,8,2,3,6,7,9", 77, 8, ["1RM12456789","72RM12356789","73RM23456789","75RM12346789"])
])
];

function step(strategyName, sudokuBefore, fixedBefore, candidatesBefore, commands) {
  this.strategyName = strategyName;
  this.sudokuBefore = sudokuBefore;
  this.fixedBefore = fixedBefore;
  this.candidatesBefore = candidatesBefore;
  this.commands = commands;
}

function solution(id, quest, result, level, unique, steps) {
  this.id = id;
  this.quest = quest;
  this.result = result;
  this.level = level;
  this.unique = unique;
  this.steps = steps;
}

function command(cmdClass, cellNumber, candidateNumber) {
  this.cmdClass = cmdClass;
  this.cellNumber = cellNumber;
  this.candidateNumber = candidateNumber;
  this.candidateNumbers = null;
  this.execute = function() {
    if (cmdClass == "createCandidate") {
      createCandidateDo(cellNumber, candidateNumber);
    } else if (cmdClass == "removeCandidate") {
      removeCandidateDo(cellNumber, candidateNumber);
    } else if (cmdClass == "setCell") {
      this.candidateNumbers = getCandidateArray(cellNumber);
      promoteCandidateDo(cellNumber, candidateNumber);
    } else if (cmdClass == "unsetCell") {
      removeFixed(cellNumber, candidateNumber);
    } else {
      alert("Unbekannter Befehl: " + cmdClass);
    }
    updateStatisticsAsync();
  }
  this.unexecute = function() {
    if (cmdClass == "createCandidate") {
      removeCandidateDo(cellNumber, candidateNumber);
    } else if (cmdClass == "removeCandidate") {
      createCandidateDo(cellNumber, candidateNumber);
    } else if (cmdClass == "setCell") {
      buildCandidates(getCellId(cellNumber));
      var index = 0;
      for (var i = 1; i <= size; i++) {
        if (i == this.candidateNumbers[index]) {
          index++;
        } else {
          removeCandidateDo(cellNumber, i);
        }
      }
    } else if (cmdClass == "unsetCell") {
      promoteCandidateDo(cellNumber, candidateNumber);
    } else {
      alert("Unbekannter Befehl: " + cmdClass);
    }
    updateStatisticsAsync();
  }
}

function resetCmdHistory() {
  undoCmd = new Array();
  doCmd = new Array();
  ableCmdButtons();
}

function ableCmdButtons() {
  if (undoCmd.length <= 0) {
    document.getElementById("undoButton").disabled=true;
  } else {
    document.getElementById("undoButton").disabled=false;
  }
  if (doCmd.length <= 0) {
    document.getElementById("doButton").disabled=true;
  } else {
    document.getElementById("doButton").disabled=false;
  }
}

function createAndExecuteCmd(cmdClass, cellNumber, candidateNumber) {
  var cmd = new command(cmdClass, cellNumber, candidateNumber);
  cmd.execute();
  this.undoCmd.push(cmd);
  this.doCmd = new Array();
  ableCmdButtons();
}

function doCommand() {
  if (doCmd.length > 0) {
    var cmd = doCmd.pop();
    cmd.execute();
    undoCmd.push(cmd);
    ableCmdButtons();
  } else {
    alert("Es liegen keine Befehle zur Ausführung vor.");
  }
}

function undoCommand() {
  if (undoCmd.length > 0) {
    var cmd = undoCmd.pop();
    cmd.unexecute();
    doCmd.push(cmd);
    ableCmdButtons();
  } else {
    alert("Es liegen keine Rückgängig-Befehle zur Ausführung vor.");
  }
}

function updateStatisticsAsync() {
  if (updateStatisticsId != null) {
    clearTimeout(updateStatisticsId);
  }
  updateStatisticsId = setTimeout(updateStatistics, 100);
}

function updateStatistics() {
  var fixedCellNumber = 0;
  var candidateNumber = 0;
  for (var i = 1; i <= size * size; i++) {
    if (isCellFixed(i)) {
      fixedCellNumber++;
    } else {
      for (var k = 1; k <= size; k++) {
        var candidate = getCandidate(i, k);
        if (candidate.firstChild != null && candidate.firstChild.nodeType == 3) {
          candidateNumber++;
        }
      }
    }
    checkConflict(i);
  }
  document.getElementById("fixedCellNumber").value = fixedCellNumber;
  document.getElementById("candidateNumber").value = candidateNumber;
  var board = document.getElementById("board");
  if (candidateNumber == 0 && fixedCellNumber == size * size) {
    if (isSolved()) {
      board.className = addStyle(board.className, "solved");
    }
  } else {
      board.className = removeStyle(board.className, "solved");
  }
}

function switchVisibility(switchId) {
  var configSwitch = document.getElementById(switchId);
  var configSwitchBlock = document.getElementById(configSwitch.id + "Block");
  var content = configSwitch.firstChild.data;
  if (configSwitch.firstChild.data.match(/^\+$/)) {
    configSwitch.replaceChild(document.createTextNode("-"), configSwitch.firstChild);
    configSwitchBlock.style.visibility = "visible";
    configSwitchBlock.style.display = "block";
  } else {
    configSwitch.replaceChild(document.createTextNode("+"), configSwitch.firstChild);
    configSwitchBlock.style.visibility = "hidden";
    configSwitchBlock.style.display = "none";
  }
}

function addStyle(style, newStyle) {
  var erg = style.indexOf(newStyle);
  if (erg >= 0) {
    return style;
  } else {
    return style + " " + newStyle;
  }
}

function removeStyle(style, oldStyle) {
  var erg = style.indexOf(" " + oldStyle);
  if (erg >= 0) {
    return style.substr(0, erg);
  } else {
    return style;
  }
}

function getCell(cellId) {
  return document.getElementById(cellId);
}

function getCellId(cellNumber) {
  return "cell" + cellNumber;
}

function getCandidate(cellNumber, c) {
  return document.getElementById(getCandidateId(getCellId(cellNumber), c));
}

function getCandidateId(cellId, c) {
  return cellId + "candidate" + c;
}

function getColumnNumber(cellNumber) {
  column = cellNumber % size;
  if (column == 0) {
    return size;
  }
  return column;
}

function getBlockNumber(cellNumber) {
  row = getRowNumber(cellNumber);
  column = getColumnNumber(cellNumber);
  return Math.floor((row - 1)/ subSize) * subSize + Math.floor((column - 1)/ subSize) + 1;
}

function getFixedValue(cellNumber) {
  if (isCellFixed(cellNumber)) {
    return getValue(getCell(getCellId(cellNumber)));
  }
  return null;
}

function getRowNumber(cellNumber) {
  return Math.floor((cellNumber - 1)/ size) + 1;
}

function getValue(node) {
  return parseInt(node.firstChild.data);
}

function isCellFixed(cellNumber) {
  if (getCell(getCellId(cellNumber)).firstChild.nodeType == 3) {
    return true;
  }
  return false;
}

function buildBoard() {
  var boardTable = document.createElement("table");
  boardTable.id = "board";
  boardTable.border = "0";
  boardTable.cellPadding = "0";
  boardTable.cellSpacing = "0";
  document.getElementById("sudoku").appendChild(boardTable);
  var row = null;
  for (var i = 1; i <= size * size; i++) {
    if (i % size == 1) {
      var row = document.createElement("tr");
      row.id = "row" + (Math.floor(i / size) + 1);
      boardTable.appendChild(row);
    }
    var cell = document.createElement("td");
    cell.id = getCellId(i);
    cell.className = "fixed block" + getBlockNumber(i);
    row.appendChild(cell);
    var cellText = document.createTextNode(i);
    cell.appendChild(cellText);
  }
}

function buildCandidates(cellId) {
  cell = getCell(cellId);
  cell.className = removeStyle(cell.className, "original")
  cell.className = removeStyle(cell.className, "conflict")
  cell.className = removeStyle(cell.className, "highlight3")
  cell.onmouseover = null;
  cell.onmouseout = null;
  cell.onclick = null;
  cell.ondblclick = null;
  candidatesTable = document.createElement("table");
  candidatesTable.id = cellId + "candidate";
  candidatesTable.border = "0"
  candidatesTable.cellPadding = "0";
  candidatesTable.cellSpacing = "0";
  var candidatesRow = null;
  for (var i = 1; i <= size; i++) {
    if (i % subSize == 1) {
      candidatesRow = document.createElement("tr");
      candidatesRow.id = cellId + "row" + (Math.floor(i / subSize) + 1);
      candidatesTable.appendChild(candidatesRow);
    }
    candidatesCell = document.createElement("td");
    candidatesCell.id = getCandidateId(cellId, i);
    candidatesCell.className = "candidate";
    if (document.getElementById("candidateButton" + i).className.match(/candidateButtonOn/g)) {
      candidatesCell.className = addStyle(candidatesCell.className, "highlight1");
    }
    candidatesCell.onmouseover = enterCandidate;
    candidatesCell.onmouseout = exitCandidate;
    candidatesCell.onclick = removeCandidate;
    candidatesCell.ondblclick = promoteCandidate;
    candidatesRow.appendChild(candidatesCell);
    if (isSpielweiseKandidatenEntfernen()) {
      cellText = document.createTextNode(i);
      candidatesCell.appendChild(cellText);
    }
  }
  cell.replaceChild(candidatesTable, cell.firstChild);
}

function buildFixed(cellNumber, value) {
  cell = getCell(getCellId(cellNumber));
  cell.className = removeStyle(cell.className, "conflict")
  cell.onmouseover = enterFixed;
  cell.onmouseout = exitFixed;
  if (isInOriginal(cellNumber)) {
    cell.className = addStyle(cell.className, "original");
  } else {
    cell.className = removeStyle(cell.className, "original");
  }
  var cellText = document.createTextNode(value);
  cell.replaceChild(cellText, cell.firstChild);
}

function loadSudoku() {
  if (document.getElementById("sudokuAsString").value.match(/^[0-9\.]{81}$/)) {
    original = document.getElementById("sudokuAsString").value;
    for (var i = 1; i <= size * size; i++) {
      value = original.substr(i - 1, 1);
      if (value == ".") {
        buildCandidates(getCellId(i));
      } else {
        buildFixed(i, value);
      }
    }
  } else {
    if (!parseSudokuString(document.getElementById("sudokuAsString").value)) {
      alert("Sudoku ist ungültig!");
    }
  }
  resetCmdHistory();
  updateStatisticsAsync();
}

function removeAllCandidates() {
  for (var i = 1; i <= size * size; i++) {
    if (isCellFixed(i)) {
      // Nix machen!
    } else {
      // Fixed aus Zeile, Spalte und Block sammeln
      removeCandidates(i);
    }
  }
}

function collectFixed(cellNumber) {
  var fixed = new Array();
  for (var i = 1; i <= size; i++) {
    fixed[i] = false;
  }
  for (var i = 1; i <= size * size; i++) {
    if (i != cellNumber) {
      if (getRowNumber(i) == getRowNumber(cellNumber)) {
        if (isCellFixed(i)) {
          fixed[getFixedValue(i)] = true;
        }
      }
      if (getColumnNumber(i) == getColumnNumber(cellNumber)) {
        if (isCellFixed(i)) {
          fixed[getFixedValue(i)] = true;
        }
      }
      if (getBlockNumber(i) == getBlockNumber(cellNumber)) {
        if (isCellFixed(i)) {
          fixed[getFixedValue(i)] = true;
        }
      }
    }
  }
  return fixed;
}

function removeCandidates(cellNumber) {
  var fixed = collectFixed(cellNumber);
  for (var i = 1; i <= size; i++) {
    if (fixed[i]) {
      var candidate = getCandidate(cellNumber, i);
      if (candidate.firstChild != null && candidate.firstChild.nodeType == 3) {
        createAndExecuteCmd("removeCandidate", cellNumber, i);
      }
    }
  }
}

function conflictsCandidate(cellNumber, c) {
  if (document.getElementById("showConflicts").checked) {
    return collectFixed(cellNumber)[c];
  }
  return false;
}

function highlightFixedOn(value) {
  for (var i = 1; i <= size * size; i++) {
    if (isCellFixed(i)) {
      var cell = getCell(getCellId(i));
      if (value == getValue(cell)) {
        cell.className = addStyle(cell.className, "highlight3");
      }
    }
  }
}

function highlightFixedOff(value) {
  for (var i = 1; i <= size * size; i++) {
    if (isCellFixed(i)) {
      var cell = getCell(getCellId(i));
      if (value == getValue(cell)) {
        cell.className = removeStyle(cell.className, "highlight3");
      }
    }
  }
}

function enterFixed() {
  var value = getValue(this);
  if (document.getElementById("highlightFixed").checked) {
    this.className = addStyle(this.className, "highlight3");
  }
  if (document.getElementById("highlightAllFixed").checked) {
    highlightFixedOn(value);
  }
  if (document.getElementById("highlightAllFixedAndCandidates").checked) {
    highlightCandidateOn(value, "highlight2");
  }
}

function exitFixed() {
  var value = getValue(this);
  this.className = removeStyle(this.className, "highlight3");
  highlightFixedOff(value);
  highlightCandidateOff(value, "highlight2");
}

function enterCandidate() {
  var value = getValue(this);
  if (document.getElementById("highlightCandidates").checked) {
    this.className = addStyle(this.className, "highlight2");
  }
  if (document.getElementById("highlightAllCandidates").checked) {
    highlightCandidateOn(value, "highlight2");
  }
  if (document.getElementById("highlightAllCandidatesAndFixed").checked) {
    highlightFixedOn(value);
  }
}

function exitCandidate() {
  var value = getValue(this);
  this.className = removeStyle(this.className, "highlight2");
  highlightCandidateOff(value, "highlight2");
  highlightFixedOff(value);
}

function removeCandidateDo(cellNumber, candidateNumber) {
  var candidate = getCandidate(cellNumber, candidateNumber);
  if (candidate.firstChild == null || candidate.firstChild.data.length <= 0) {
    return;
  }
  candidate.className = removeStyle(candidate.className, "highlight1");
  candidate.className = removeStyle(candidate.className, "highlight2");
  candidate.onmouseover = null;
  candidate.onmouseout = null;
  //candidate.onclick = null;
  //candidate.ondblclick = null;
  candidate.removeChild(candidate.firstChild);
}

function createCandidateDo(cellNumber, candidateNumber) {
  var candidate = getCandidate(cellNumber, candidateNumber);
  candidate.className = "candidate";
  candidate.onmouseover = enterCandidate;
  candidate.onmouseout = exitCandidate;
  //candidate.onclick = removeCandidate;
  //candidate.ondblclick = promoteCandidate;
  if (isCandidateButtonOn(candidateNumber)) {
    candidate.className = addStyle(candidate.className, "highlight1");
  }
  candidateText = document.createTextNode(candidateNumber);
  candidate.appendChild(candidateText);
}

function createOrRemoveCandidateDo(candidateId) {
  var candidate = document.getElementById(candidateId);
  candidateId.match(/cell(\d+)candidate(\d+)/g);
  if (candidate.firstChild != null && candidate.firstChild.nodeType == 3) {
    createAndExecuteCmd("removeCandidate", parseInt(RegExp.$1), parseInt(RegExp.$2));
  } else {
    createAndExecuteCmd("createCandidate", parseInt(RegExp.$1), parseInt(RegExp.$2));
  }
}

function promoteCandidateDo(cellNumber, candidateNumber) {
  buildFixed(cellNumber, candidateNumber);
  var cellId = getCellId(cellNumber)
  var cell = document.getElementById(cellId);
  if (conflictsCandidate(cellNumber, candidateNumber)) {
    cell.className = addStyle(cell.className, "conflict");
  }
  cell.replaceChild(document.createTextNode(candidateNumber), cell.firstChild);
  cell.onclick = resetFixed;
  checkAllConflicts(cellNumber);
}

var dblclick = false;

function removeCandidate() {
  var candidateId = this.id;
  setTimeout(function() {
    if (dblclick == true) {
      return;
    }
    createOrRemoveCandidateDo(candidateId);
  }, 250);
}

function promoteCandidate() {
  var candidateId = this.id;
  dblclick = true;
  candidateId.match(/cell(\d+)candidate(\d+)/g);
  createAndExecuteCmd("setCell", parseInt(RegExp.$1), parseInt(RegExp.$2));
  setTimeout(function() {
    dblclick = false;
  }, 250);
}

function buildCandidateButtons() {
  var candidateButtons = document.getElementById("candidateButtons");
  for (var i = 1; i <= size; i++) {
    var candidateButton = document.createElement("div");
    candidateButton.id = "candidateButton" + i;
    candidateButton.className = "candidateButtonOff";
    candidateButton.onclick = highlightCandidates;
    candidateButtons.appendChild(candidateButton);
    candidateButton.appendChild(document.createTextNode(i));
  }
}

function highlightCandidateOn(candidate, cssClassName) {
  for (var i = 1; i <= size * size; i++) {
    if (!isCellFixed(i)) {
      for (var k = 1; k <= size; k++) {
        var candidateNode = getCandidate(i, k);
        if (candidateNode.childNodes.length > 0 && candidateNode.firstChild.data.length > 0) {
          if (k == candidate) {
            candidateNode.className = addStyle(candidateNode.className, cssClassName);
          }
        }
      }
    }
  }
}

function highlightCandidateOff(candidate, cssClassName) {
  for (var i = 1; i <= size * size; i++) {
    if (!isCellFixed(i)) {
      for (var k = 1; k <= size; k++) {
        var candidateNode = getCandidate(i, k);
        if (candidateNode.childNodes.length > 0 && candidateNode.firstChild.data.length > 0) {
          if (k == candidate) {
            candidateNode.className = removeStyle(candidateNode.className, cssClassName);
          }
        }
      }
    }
  }
}

function highlightCandidates() {
  var candidate = parseInt(this.id.match(/\d+/g)[0]);
  if (this.className == "candidateButtonOff") {
    this.className = "candidateButtonOn";
    highlightCandidateOn(candidate, "highlight1");
  } else {
    this.className = "candidateButtonOff";
    highlightCandidateOff(candidate, "highlight1");
  }
}

function isCandidateButtonOn(value) {
  for (var i = 1; i <= size; i++) {
    var candidateButton = document.getElementById("candidateButton" + i);
    if (candidateButton.className.match(/candidateButtonOn/g)) {
      return true;
    }
  }
  return false;
}

function removeFixed(cellNumber, candidateNumber) {
  highlightFixedOff(candidateNumber);
  highlightCandidateOff(candidateNumber, "highlight2");
  if (isInOriginal(cellNumber)) {
    // Nix machen
  } else {
    // Reset
    buildCandidates(getCellId(cellNumber));
    checkAllConflicts(cellNumber);
  }
  if (!isSolved()) {
    var board = document.getElementById("board");
    board.className = removeStyle(board.className, "solved");
  }
}

function resetFixed() {
  var cellNumber = parseInt(this.id.match(/\d+/g)[0]);
  var value = getValue(this);
  createAndExecuteCmd("unsetCell", cellNumber, value);
}

function isInOriginal(cellNumber) {
  var originalChar = original.substr(cellNumber - 1, 1);
  if (originalChar.match(/\d+/)) {
    return true;
  }
  return false;
}

function resetAllCandidates() {
  for (var i = 1; i <= size * size; i++) {
    if (!isCellFixed(i)) {
      buildCandidates(getCellId(i));
    }
  }
}

function emptyCandidates() {
  for (var i = 1; i <= size * size; i++) {
    if (!isCellFixed(i)) {
      for (var k = 1; k <= size; k++) {
        removeCandidateDo(i, k);
      }
    }
  }
}

function getSudokuById(id) {
  for (var i = 0; i < sudokus.length; i++) {
    if (sudokus[i].id == id) {
      sudoku = sudokus[i];
    }
  }
  return sudoku;
}

function removeSteps() {
  var stepsNode = document.getElementById("steps");
  for (var i = stepsNode.childNodes.length; i > 0; i--) {
    var lastChildNode = stepsNode.childNodes[i-1];
    stepsNode.removeChild(lastChildNode);
  }
}

function highlightCmd(command, on) {
  command.match(/(\d+)(\D+)(\d+)/);
  var cellNumber = RegExp.$1;
  var cmd = RegExp.$2;
  var candidateNumbers = RegExp.$3;
  var style = "highlight2";
  if (cmd.match(/SV/)) {
    style = "highlight3";
  }
  if (!isCellFixed(cellNumber)) {
    for (var i = 0; i < candidateNumbers.length; i++) {
      var candidateNode = getCandidate(cellNumber, candidateNumbers[i]);
      if (candidateNode.childNodes.length > 0 && candidateNode.firstChild.data.length > 0) {
        if (on) {
          candidateNode.className = addStyle(candidateNode.className, style);
        } else {
          candidateNode.className = removeStyle(candidateNode.className, style);
        }
      }
    }
  }
}

function highlightCmdOn(command) {
  highlightCmd(command, true);
}

function highlightCmdOff(command) {
  highlightCmd(command, false);
}

function buildCommand(stepNode, command) {
  var cmdNode = document.createElement("span");
  domCreateAttr(cmdNode, "onmouseover", "highlightCmdOn('" + command + "')");
  domCreateAttr(cmdNode, "onmouseout", "highlightCmdOff('" + command + "')");
  var cmdText = document.createTextNode(command);
  cmdNode.appendChild(cmdText);
  stepNode.appendChild(cmdNode);
}

function domCreateAttr(node, attrName, attrValue) {
  var attr = document.createAttribute(attrName);
  attr.nodeValue = attrValue;
  node.setAttributeNode(attr);
}

function loadStep(stepNr) {
  document.getElementById("sudokuAsString").value = sudoku.steps[stepNr].sudokuBefore;
  loadSudoku();
}

function buildStep(stepNr, step) {
  var stepsNode = document.getElementById("steps");
  var stepNode = document.createElement("p");
  var stepText = document.createTextNode(" " + step.strategyName + " Vorher: " + step.fixedBefore + " / " + step.candidatesBefore);
  stepNode.appendChild(stepText);
  var stepButton = document.createElement("input");
  domCreateAttr(stepButton, "type", "button");
  domCreateAttr(stepButton, "value", "Laden");
  domCreateAttr(stepButton, "onclick", "loadStep('" + stepNr + "')");
  stepNode.appendChild(stepButton);
  var stepBreak = document.createElement("br");
  stepNode.appendChild(stepBreak);
  for (var i = 0; i < step.commands.length; i++) {
    if (i != 0) {
      var cmdText = document.createTextNode(", ");
      stepNode.appendChild(cmdText);
    }
    buildCommand(stepNode, step.commands[i]);
  }
  stepsNode.appendChild(stepNode);
}

function buildSolution() {
  removeSteps();
  for (var i = 0; i < sudoku.steps.length; i++) {
    buildStep(i, sudoku.steps[i]);
  }
}

function copyAndLoadSudoku() {
  getSudokuById(document.getElementById("quests").value);
  document.getElementById("sudokuAsString").value = sudoku.quest;
  loadSudoku();
  buildSolution();
}

function checkAllConflicts(cellNumber) {
  for (var i = 1; i <= size * size; i++) {
    if (getRowNumber(i) == getRowNumber(cellNumber)) {
      if (isCellFixed(i)) {
        checkConflict(i);
      }
    }
    if (getColumnNumber(i) == getColumnNumber(cellNumber)) {
      if (isCellFixed(i)) {
        checkConflict(i);
      }
    }
    if (getBlockNumber(i) == getBlockNumber(cellNumber)) {
      if (isCellFixed(i)) {
        checkConflict(i);
      }
    }
  }
}

function checkConflict(cellNumber) {
  var showConflicts = document.getElementById("showConflicts").checked;
  var cellId = getCellId(cellNumber);
  var cell = document.getElementById(cellId);
  if (isCellFixed(cellNumber)) {
    if (showConflicts && conflictsCandidate(cellNumber, getFixedValue(cellNumber))) {
      cell.className = addStyle(cell.className, "conflict");
    } else {
      cell.className = removeStyle(cell.className, "conflict");
    }
  }
}

function hideCandidates() {
  var hideButton = document.getElementById("hideButton");
  if (hideButton.value == "Ausblenden") {
    for (var i = 1; i <= size * size; i++) {
      if (!isCellFixed(i)) {
        for (var k = 1; k <= size; k++) {
          var candidate = getCandidate(i, k);
          candidate.className = addStyle(candidate.className, "hide");
        }
      }
    }
    hideButton.value = "Einblenden";
  } else {
    for (var i = 1; i <= size * size; i++) {
      if (!isCellFixed(i)) {
        for (var k = 1; k <= size; k++) {
          var candidate = getCandidate(i, k);
          candidate.className = removeStyle(candidate.className, "hide");
        }
      }
    }
    hideButton.value = "Ausblenden";
  }
}

function saveSudoku() {
  var sudokuAsString = buildSudokuString(false);
  document.getElementById("sudokuAsString").value = sudokuAsString;
}

function isSolved() {
  var sum = (size * (size + 1)) / 2;
  var rowSum = new Array();
  var columnSum = new Array();
  var blockSum = new Array();
  for (var i = 1; i <= size; i++) {
    rowSum[i] = 0;
    columnSum[i] = 0;
    blockSum[i] = 0;
  }
  for (var i = 1; i <= size * size; i++) {
    if (isCellFixed(i)) {
      rowSum[getRowNumber(i)] = rowSum[getRowNumber(i)] + getFixedValue(i);
      columnSum[getColumnNumber(i)] = columnSum[getColumnNumber(i)] + getFixedValue(i);
      blockSum[getBlockNumber(i)] = blockSum[getBlockNumber(i)] + getFixedValue(i);
    }
  }
  for (var i = 1; i <= size; i++) {
    if (rowSum[i] != sum) {
      return false;
    }
    if (columnSum[i] != sum) {
      return false;
    }
    if (blockSum[i] != sum) {
      return false;
    }
  }
  return true;
}

function eraseCookie(name) {
  var domain = null; //"jdufner.de";
  var expires = new Date((new Date()).getTime() - 1000*3600*24).toGMTString();
  var path = null;
  //var secure = null;
  var cook = name + "=";
  cook += (domain) ? "; domain=" + domain : "";
  cook += (expires) ? "; expires=" + expires : "";
  cook += (path) ? "; path=" + path : "";
  //cook += (secure) ? "; secure" : "";
  document.cookie = cook;
}

function setCookie(name, wert) {
  var domain = null; //"jdufner.de";
  var expires = new Date((new Date()).getTime() + 1000*3600*24*7).toGMTString();
  var path = null;
  //var secure = null;
  var cook = name + "=" + unescape(wert);
  cook += (domain) ? "; domain=" + domain : "";
  cook += (expires) ? "; expires=" + expires : "";
  cook += (path) ? "; path=" + path : "";
  //cook += (secure) ? "; secure" : "";
  document.cookie = cook;
}

function getCookie(name) {
  var i = 0;  //Suchposition im Cookie
  var suche = name + "=";
  while (i < document.cookie.length) {
    if (document.cookie.substring(i, i + suche.length) == suche) {
      var ende = document.cookie.indexOf(";", i + suche.length);
      if (ende <= -1) {
        ende = document.cookie.length;
      }
      var cook = document.cookie.substring(i + suche.length, ende);
      return unescape(cook);
    }
    i++;
  }
  return "";
}

function getCandidateArray(cellNumber) {
  var candidates = new Array();
  for (var i = 1; i <= size; i++) {
    var candidate = getCandidate(cellNumber, i);
    if (candidate.firstChild != null && candidate.firstChild.nodeType == 3) {
      candidates.push(i);
    }
  }
  return candidates;
}

function buildCandidateString(cellNumber) {
  if (getCandidateArray(cellNumber).length == 0) {
    return ""
  } else {
    return "(" + getCandidateArray(cellNumber).join("") + ")";
  }
}

function buildSudokuString(forceIncloseCandidates) {
  var sudoku = new Array();
  var incloseCandidates = document.getElementById("incloseCandidates").checked;
  for (var i = 1; i <= size * size; i++) {
    if (isCellFixed(i)) {
      sudoku[i-1] = getFixedValue(i);
    } else {
      if (forceIncloseCandidates || incloseCandidates) {
        sudoku[i-1] = buildCandidateString(i);
      } else {
        sudoku[i-1] = ".";
      }
    }
  }
  if (forceIncloseCandidates || incloseCandidates) {
    return sudoku.join(",");
  } else {
    return sudoku.join("");
  }
}

function saveSudokuInCookie() {
  var sudokuString = buildSudokuString(true);
  if (sudokuString.length > 4000) {
    alert("Sudoku kann nicht gespeichert werden");
  }
  setCookie("SudokuAsString", sudokuString);
}

function buildCandidatesFromString(cellNumber, candidatesString) {
  var allCandidates = []; // ["1","2","3","4","5","6","7","8","9"];
  if (candidatesString.length == 0) {
    if (!isSpielweiseKandidatenEntfernen()) {
      var cellId = getCellId(cellNumber);
      buildCandidates(cellId);
      var candidate = parseInt(allCandidates.shift());
      for (var k = 1; k <= size; k++) {
        if (k != candidate) {
          removeCandidateDo(cellNumber, k);
        } else {
          candidate = parseInt(allCandidates.shift());
        }
      }


    }
  }
  if (candidatesString.match(/^\(([0-9]+)\)$/)) {
    var candidates = RegExp.$1.split("");
    var cellId = getCellId(cellNumber);
    buildCandidates(cellId);
    var candidate = parseInt(candidates.shift());
    for (var k = 1; k <= size; k++) {
      if (k != candidate) {
        removeCandidateDo(cellNumber, k);
      } else {
        candidate = parseInt(candidates.shift());
      }
    }
  } else {
    return false;
  }
}

function parseSudokuString(sudokuString) {
  var sudoku = sudokuString.split(",");
  original = "";
  for (var i = 1; i <= size * size; i++) {
    if (sudoku[i-1].match(/^(\d+)$/)) {
      // fixed
      original += parseInt(RegExp.$1);
    } else {
      // candidates
      original += ".";
    }
  }
  for (var i = 1; i <= size * size; i++) {
    if (sudoku[i-1].match(/^(\d+)$/)) {
      // fixed
      buildFixed(i, parseInt(RegExp.$1));
    } else {
      // candidates
      buildCandidatesFromString(i, sudoku[i-1]);
    }
  }
  return true;
}

function loadSudokuFromCookie() {
  var sudokuString = getCookie("SudokuAsString");
  parseSudokuString(sudokuString);
  resetCmdHistory();
  updateStatisticsAsync();
}

function isSpielweiseKandidatenEntfernen() {
  var kandidatenEntfernen = document.getElementById("kandidatenEntfernen");
  if (kandidatenEntfernen.checked == true) {
    return true;
  }
  return false;
}

function buildQuests() {
  var questsNode = document.getElementById("quests");
  for (var i = 0; i < this.sudokus.length; i++) {
    var optionNode = document.createElement("option");
    var valueAttribute = document.createAttribute("value");
    valueAttribute.nodeValue = sudokus[i].id;
    optionNode.setAttributeNode(valueAttribute);
    var textNode = document.createTextNode(sudokus[i].id + " " + sudokus[i].level);
    optionNode.appendChild(textNode);
    questsNode.appendChild(optionNode);
  }
}

function saveConfig() {
  setCookie("showConflicts", document.getElementById("showConflicts").checked)
  setCookie("kandidatenEntfernen", document.getElementById("kandidatenEntfernen").checked)
  setCookie("kandidatenSetzen", document.getElementById("kandidatenSetzen").checked)
}

function loadConfig() {
  document.getElementById("showConflicts").checked = getCookie("showConflicts") == "true" ? true : false;
  document.getElementById("kandidatenEntfernen").checked = getCookie("kandidatenEntfernen") == "true" ? true : false;
  document.getElementById("kandidatenSetzen").checked = getCookie("kandidatenSetzen") == "true" ? true : false;
}

function turnShowConflicts() {
  for (var i = 1; i <= size * size; i++) {
    checkAllConflicts(i);
  }
}

function main() {
  buildBoard();
  buildCandidateButtons();
  buildQuests();
  loadConfig();
}

main();

-->
  </script>
</html>
